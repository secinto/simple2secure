[
	{
		"name": "Windows Certificate Issues",
		"description": "Queries which can be used to obtain information about the installed and used certificates as well as possible issues with them",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "Expired Certificates (German)",
				"sqlQuery": "select common_name, datetime(not_valid_after, 'unixepoch') as expiration_date from certificates where path like 'CurrentUser\\Vertrauens%' ORDER BY expiration_date ASC;",
				"description": "Returns the list of certificates of CAs which have already expired",		
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Expired Certificates (English)",
				"sqlQuery": "select common_name, datetime(not_valid_after, 'unixepoch') as expiration_date from certificates where path like 'CurrentUser\\Trusted%' ORDER BY expiration_date ASC;",
				"description": "Returns the list of certificates of CAs which have already expired",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			}
		]
	},
	{
		"name": "Connection & Network Issues",
		"description": "Queries check possible connection and network issues",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "Outbound Traffic not HTTP(S)",
				"sqlQuery": "select s.pid, p.name, local_address, remote_address, family, protocol, local_port, remote_port from process_open_sockets s join processes p on s.pid = p.pid where remote_port not in (80, 443) and family = 2;",
				"description": "List all processes which have outbound traffic not to port 80 and 443",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Listening ports per processes",
				"sqlQuery": "select p.name, p.path, lp.port, lp.address, lp.protocol  from listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';",
				"description": "Obtains the listening ports and to which processes they are associated",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 7,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Listening connections per processes",
				"sqlQuery": "select DISTINCT p.name, p.path, pos.remote_address, pos.remote_port from process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';",
				"description": "Obtains the listening connections and to which processes they are associated",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 7,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			}
		]
	},
	{
		"name": "General System Monitoring",
		"description": "Queries which obtains general system topics",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "Most active processes",
				"sqlQuery": "select count(pid) as total, name from processes name by name order by total desc limit 10;",
				"description": "Returns process count and name fo the top 10 most active processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Video card info",
				"sqlQuery": "select * from video_info;",
				"description": "Obtains relevant information about the used video card",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Disk performance",
				"sqlQuery": "select * from physical_disk_performance;",
				"description": "Obtains relevant information about the disk performance",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Patches",
				"sqlQuery": "select * from patches;",
				"description": "Obtains relevant information about the patches applied to the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Logical drives",
				"sqlQuery": "select * from logical_drives;",
				"description": "Obtains relevant information about the logical drives",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Logged in users",
				"sqlQuery": "select * from logged_in_users;",
				"description": "Obtains the logged in users",
				"analysisInterval": 5,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1
			},
			{
				"name": "Autoexec applications",
				"sqlQuery": "select * from autoexec;",
				"description": "Obtains all applications which are in automatically started",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Bios info - Windows",
				"sqlQuery": "select * from wmi_bios_info;",
				"description": "Obtains relevant information about BIOS of the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Installed programs",
				"sqlQuery": "select name, version, install_location, install_source, publisher, install_date from programs where name != '';",
				"description": "Obtains relevant information about applications installed on the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Logon sessions",
				"sqlQuery": "select * from logon_sessions;",
				"description": "Obtains relevant information about current logon sessions",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "OS version",
				"sqlQuery": "select * from os_version;",
				"description": "Obtains relevant information about the used operating system used on the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Open sockets processes",
				"sqlQuery": "select * from process_open_sockets;",
				"description": "Obtains the open sockets for each process",
				"analysisInterval": 5,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Platform info",
				"sqlQuery": "select * from platform_info;",
				"description": "Obtains relevant information about the underlaying platform of the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Scheduled tasks (Windows)",
				"sqlQuery": "select * from scheduled_tasks;",
				"description": "Obtains relevant information about the currently scheduled tasks",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Shared resources",
				"sqlQuery": "select * from shared_resources;",
				"description": "Obtains relevant information about the resources shared on the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Startup items",
				"sqlQuery": "select * from startup_items;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "System info",
				"sqlQuery": "select * from system_info;",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Kernel info",
				"sqlQuery": "select * from kernel_info;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Network interface details",
				"sqlQuery": "select * from interface_details;",
				"description": "Obtains the details for all network interfaces in the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Network interface addresses",
				"sqlQuery": "select * from interface_addresses;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Internet Explorer extensions",
				"sqlQuery": "select * from ie_extensions;",
				"analysisInterval": 5,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "List of certificates",
				"sqlQuery": "select * from certificates;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Chrome extensions",
				"sqlQuery": "select * from chrome_extensions;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Processes memory map",
				"sqlQuery": "select * from process_memory_map;",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Pipes",
				"sqlQuery": "select * from pipes;",
				"analysisInterval": 5,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Listening ports",
				"sqlQuery": "select * from listening_ports;",
				"analysisInterval": 5,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Running processes",
				"sqlQuery": "select * from processes;",
				"description": "List all running processes",
				"analysisInterval": 5,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Uptime",
				"sqlQuery": "select * from uptime;",
				"description": "Obtain how long the system is already running without a reboot",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Users",
				"sqlQuery": "select * from users;",
				"description": "List all users on system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Active routes",
				"sqlQuery": "select * from routes;",
				"description": "Obtain the currently active routes of the system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": true
			},
			{
				"name": "Hosts file",
				"sqlQuery": "select * from etc_hosts;",
				"description": "Obtain the contains from the hosts file",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "ARP cache",
				"sqlQuery": "select * from arp_cache;",
				"description": "Obtain the contents of the ARP cache",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Disk info",
				"sqlQuery": "select * from disk_info;",
				"description": "Obtains the current disk info",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "CPU info",
				"sqlQuery": "select * from cpu_info;",
				"description": "Obtains the current CPU info from the monitored system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "System time",
				"sqlQuery": "select * from system time;",
				"description": "Obtains the current system time",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows crashes",
				"sqlQuery": "select * from windows_crashes;",
				"description": "Obtains the crashes reported for this windows system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows events",
				"sqlQuery": "select * from windows_events;",
				"description": "Obtains the events from the log of the monitored system",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows registry",
				"sqlQuery": "select * from registry;",
				"description": "Obtains everything from the registry",
				"analysisInterval": 30,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows services",
				"sqlQuery": "select * from services;",
				"description": "Obtains the services which are available on the monitored systems",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			}
		]
	},
	{
		"name": "Processes and Services Activity",
		"description": "Checks fine-grained information from processes and services",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "Most memory intensive processes",
				"sqlQuery": "SELECT pid, name, ROUND((total_size * '10e-7'), 2) AS used FROM processes ORDER BY total_size DESC LIMIT 10;",
				"description": "Obtains the 10 most memory intensive processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 7,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": true
			},
			{
				"name": "Most CPU intensive processes since boot",
				"sqlQuery": "SELECT (SUM(user) + SUM(nice) + SUM(system) + SUM(idle) * 1.0) AS tsb, SUM(COALESCE(idle, 0)) + SUM(COALESCE(iowait, 0)) AS itsb FROM cpu_time;",
				"description": "Obtains the most CPU intensive processes which have been executed since boot",
				"analysisInterval": 5,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 2,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Most CPU intensive processes since boot 2",
				"sqlQuery": "SELECT pid, uid, name, ROUND((   (user_time + system_time) / (cpu_time.tsb - cpu_time.itsb) ) * 100, 2) AS percentage FROM processes, ( SELECT (   SUM(user) + SUM(nice) + SUM(system) + SUM(idle) * 1.0) AS tsb,   SUM(COALESCE(idle, 0)) + SUM(COALESCE(iowait, 0)) AS itsb   FROM cpu_time ) AS cpu_time ORDER BY user_time+system_time DESC LIMIT 10;",
				"description": "Obtains a list of the 10 most CPU intensive processes since boot - second edition for verification",
				"analysisInterval": 5,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 2,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Recent User Processes",
				"sqlQuery": "SELECT pid, username, name FROM processes p JOIN users u ON u.uid = p.uid AND name != 'osqueryi.exe' ORDER BY start_time DESC LIMIT 10;",
				"description": "Obtains the 10 most recent user processes which where executed",
				"analysisInterval": 10,
				"analysisIntervalUnit": "MINUTES",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "List of running services",
				"sqlQuery": "select processes.pid, processes.name, users.username, processes.path, processes.cmdline from processes LEFT JOIN users ON processes.uid = users.uid AND processes.name != 'osqueryi.exe' WHERE processes.path != '';",
				"description": "List Windows System running processes.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Scheduled Tasks Windows",
				"sqlQuery": "select name,action,path,enabled,datetime(next_run_time,'unixepoch','UTC') from scheduled_tasks;",
				"description": "Lists all of the tasks in the Windows task scheduler",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Process without binary on disk",
				"sqlQuery": "SELECT name, path, pid FROM processes WHERE on_disk = 0;",
				"description": "Detect Processes running without a binary on disk",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Services started automatically",
				"sqlQuery": "SELECT * FROM services WHERE start_type='DEMAND_START' OR start_type='AUTO_START';",
				"description": "Lists all installed services configured to start automatically at boot",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows_Defender_Services",
				"sqlQuery": "SELECT * FROM services WHERE name = 'WinDefend' AND status != 'RUNNING';",
				"description": "Windows Defender service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows_Firewall_Services",
				"sqlQuery": "SELECT * FROM services WHERE name = 'MpsSvc' AND status != 'RUNNING';",
				"description": "Windows Firewall service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Symantec_Endpoint_Protection_Services",
				"sqlQuery": "SELECT * FROM services WHERE name = 'SepMasterService' AND status != 'RUNNING';",
				"description": "Symantec Endpoint Protection service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Sophos_Anti-Virus_Services_1",
				"sqlQuery": "SELECT * FROM services WHERE name = 'SAVAdminService' AND status != 'RUNNING';",
				"description": "Symantec Endpoint Protection service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Sophos_Anti-Virus_Services_2",
				"sqlQuery": "SELECT * FROM services WHERE name = 'SavService' AND status != 'RUNNING';",
				"description": "Symantec Endpoint Protection service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 0,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows_Security_Service",
				"sqlQuery": "SELECT * FROM services WHERE name = 'wscsvc' AND status != 'RUNNING';",
				"description": "Windows Security Service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Windows_Update_Service",
				"sqlQuery": "SELECT * FROM services WHERE name = 'wuauserv' AND status != 'RUNNING';",
				"description": "Windows Update Service Status change",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "svchost.exe_no_K_option",
				"sqlQuery": "select * from processes where name like 'svchost.exe' and cmdline not like '%-k%';",
				"description": "SVCHOST Processes not using the -k [name] convention",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			}
		]
	},
	{
		"name": "Suspicious File System Events",
		"description": "Checks for suspicious file system activity and modifications",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "Snaphost_Prefetch_File",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\';",
				"description": "Snapshot Prefetch File Directory",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "windows_new_file",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\Windows\\%' and type='regular';",
				"description": "Check suspicious file creation under c:\\windows",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "windows_temp",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\Windows\\temp\\%' and type='regular';",
				"description": "Check suspicious file creation under c:\\windows\\temp",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Roaming",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\users\\%\\AppData\\Roaming\\%' and type='regular';",
				"description": "Check suspicious file creation under %APPDATA% or %\\AppData\\Roaming",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Local",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\users\\%\\AppData\\Local\\%' and type='regular';",
				"description": "Check suspicious file creation under AppData\\Local",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Local_temp",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\users\\%\\AppData\\Local\\temp\\%' and type='regular';",
				"description": "Check suspicious file creation under %TEMP% or AppData\\Local\\Temp",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "User_StartMenu_startup",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\%' AND type='regular';",
				"description": "Check suspicious file creation under Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "User_StartMenu_program",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\%' AND type='regular';",
				"description": "Check suspicious file creation under Roaming\\Microsoft\\Windows\\Start Menu\\Programs - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Programmata_StartMenu",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\%' AND type='regular';",
				"description": "Check suspicious file creation under ProgramData\\Microsoft\\Windows\\Start Menu - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Programmata_StartMenu_program",
				"sqlQuery": "SELECT hash.md5, path, file.filename, datetime(file.btime, 'unixepoch', 'UTC') as btime, datetime(file.atime, 'unixepoch', 'UTC') as atime, datetime(file.ctime, 'unixepoch', 'UTC') as ctime, datetime(file.mtime, 'unixepoch', 'UTC') as mtime FROM hash JOIN file USING (path) where path like 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\%' AND type='regular';",
				"description": "Check suspicious file creation under ProgramData\\Microsoft\\Windows\\Start Menu\\Programs - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "windows_new_directory",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\Windows\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under c:\\windows",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "windows_temp_new_directory",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\Windows\\temp\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under c:\\windows\\temp",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Roaming_new_directory",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\users\\%\\AppData\\Roaming\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under %APPDATA% or %\\AppData\\Roaming",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Local_new_directory",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\users\\%\\AppData\\Local\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under AppData\\Local",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppData_Local_temp_directory",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\users\\%\\AppData\\local\\temp\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under %TEMP% or AppData\\Local\\Temp",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "User_StartMenu_startup",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "User_StartMenu_program",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under Roaming\\Microsoft\\Windows\\Start Menu\\Programs - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "programmata_StartMenu",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under ProgramData\\Microsoft\\Windows\\Start Menu - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "programmata_StartMenu_program",
				"sqlQuery": "select f.path,f.directory,u.username,f.hard_links,f.symlink,datetime(f.btime, 'unixepoch', 'UTC') as btime, datetime(f.atime, 'unixepoch', 'UTC') as atime, datetime(f.ctime, 'unixepoch', 'UTC') as ctime, datetime(f.mtime, 'unixepoch', 'UTC') as mtime from file f LEFT JOIN users u on f.uid=u.uid where f.path like 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\%' AND f.type='directory';",
				"description": "Check suspicious directory creation under ProgramData\\Microsoft\\Windows\\Start Menu\\Programs - ATT&CK T1060,T1023",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			}
		]
	},
	{
		"name": "Windows Hardening",
		"description": "Obtains information which can be set in order to hardnen a windows system configuration",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "UAC disabled",
				"sqlQuery": "SELECT * FROM registry WHERE path='HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\EnableLUA' AND data=0;",
				"description": "Controls UAC. A setting of 0 indicates that UAC is disabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 0,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Weak_Crypto",
				"sqlQuery": "select * from registry where path like 'HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CertDllCreateCertificateChainEngine\\\\Config\\\\Default\\\\%' AND name IN ('WeakSha1ThirdPartyFlags','WeakMd5ThirdPartyFlags') AND type = 'REG_DWORD' AND data not like '-2%';",
				"description": "Protection Against Weak Crypto Algorithms",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Font Blocking",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows NT\\\\MitigationOptions\\\\MitigationOptions_FontBlocking';",
				"description": "Checks if FontBlocking is enabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Data Execution Prevention (DEP) enabled",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SystemStartOptions';",
				"description": "Checks if DEP is enabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Data Exection Protection with Mitigation",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Kernel\\\\MitigationOptions';",
				"description": "Checks if DEP with mitigation options is enabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Address Space Location Randomization (ASLR)",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\\\\moveImages';",
				"description": "Checks if ASLR is enabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Structured Exception Handling Overwrite Protection",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Kernel\\\\KernelSEHOPEnabled';",
				"description": "Checks if SEHOP is enabled",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Certification Padding",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\WinTrust\\\\Config\\\\EnableCertPaddingCheck';",
				"description": "Checks the state of certification padding",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Certification Padding 64 Bit",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Cryptography\\\\WinTrust\\\\Config\\\\EnableCertPaddingCheck';",
				"description": "Checks state of certification padding for 64 bit",
				"analysisInterval": 1,
				"analysisIntervalUnit": "DAYS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Secure Search Path",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\CWDIllegalInDllSearch';",
				"description": "Checks secure search path check",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "DisabledExceptionChainValidation",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\kernel\\DisableExceptionChainValidation';",
				"description": "Check SEHOP state: DisabledExceptionChainValidation",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "EnableLowVaAccess",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\EnableLowVaAccess';",
				"description": "Check Kernel Null page state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "ControlFlowGuard",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\EnableCfg';",
				"description": "Check Control Flow Guard state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "App_ExecuteOptions",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\%Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\%\\executeOptions';",
				"description": "Check Applications opted in for DEP",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "App_MitigationOptions",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\%Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\%\\MitigationOptions';",
				"description": "Check Applications opted in for DEP",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "AppCompat",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\%Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers';",
				"description": "Check Applications opted in for DEP",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "App_disabledExceptionChainValidation",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\%Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\%\\DisableExceptionChainValidation';",
				"description": "Check Applications not supporting SEHOP",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "DefaultLevelMachine",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\DefaultLevel';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "DefaultLevelUser",
				"sqlQuery": "select * from registry where key like 'HKEY_USERS\\%\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\DefaultLevel';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "PolicyScopeMachine",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\PolicyScope';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "PolicyScopeUser",
				"sqlQuery": "select * from registry where key like 'HKEY_USERS\\%\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\PolicyScope';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "ExecutableTryMachine",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\ExecutableTry';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "ExecutableTryUser",
				"sqlQuery": "select * from registry where key like 'HKEY_USERS\\%\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\ExecutableTry';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "TransparentEnabledMachine",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\TransparentEnabled';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "TransparentEnabledUser",
				"sqlQuery": "select * from registry where key like 'HKEY_USERS\\%\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\TransparentEnabled';",
				"description": "Check Software Restriction Policies state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Unrestricted",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144';",
				"description": "Check Software Restriction Policies state: No SRP whitelist rules",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Unrestricted_Paths",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Paths';",
				"description": "Check Software Restriction Policies state: No SRP path rules",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Unrestricted_Paths_ItemData",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\262144\\Paths\\%\\ItemData';",
				"description": "Check Software Restriction Policies state: SRP whitelist rules is missing",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Disallowed",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0';",
				"description": "Check Software Restriction Policies state: No SRP blacklist rules",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Disallowed_Paths",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Paths';",
				"description": "Check Software Restriction Policies state: No SRP path rules",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "Disallowed_Paths_ItemData",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\0\\Paths\\%\\ItemData';",
				"description": "Check Software Restriction Policies state: SRP blacklist rule is missing",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "SaferFlags",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers\\%\\%\\%\\SaferFlags';",
				"description": "Check Software Restriction Policies state: SRP rule is not enforcing",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "RuleSetEnforcementMode",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\SrpV2\\%\\EnforcementMode';",
				"description": "Check Applocker rule set configuration",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": false,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "Rule",
				"sqlQuery": "select * from registry where key like 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\SrpV2\\%\\%\\Value';",
				"description": "Check Applocker rule set",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "AuditSpecialnames",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit';",
				"description": "Check Special Logon Audit configuration - https://blogs.technet.microsoft.com/jepayne/2015/11/26/tracking-lateral-movement-part-one-special-names-and-specific-service-accounts/",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "SysmonConfig",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SYSTEM\\CCS\\Services\\SysmonDrv\\Parameters';",
				"description": "Check Microsoft Sysinternals Sysmon config",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			},
			{
				"name": "DeveloperMode",
				"sqlQuery": "select * from registry where key='HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock';",
				"description": "Check Developer Mode state",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": true,
				"graphAble": false
			}
		]
	},
	{
		"name": "Known Windows Attacks",
		"description": "Information gathering for known Windows attacks.",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "conhost.exe_incorrect_path",
				"sqlQuery": "SELECT * FROM processes WHERE LOWER(name)='conhost.exe' AND LOWER(path)!='c:\\windows\\system32\\conhost.exe' AND path!='';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "conhost.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='csrss.exe') AND LOWER(name)='conhost.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "dllhost.exe_incorrect_path",
				"sqlQuery": "SELECT * FROM processes WHERE LOWER(name)='dllhost.exe' AND LOWER(path)!='c:\\windows\\system32\\dllhost.exe' AND LOWER(path)!='c:\\windows\\syswow64\\dllhost.exe' AND path!='';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "lsass.exe_incorrect_path",
				"sqlQuery": "SELECT * FROM processes WHERE LOWER(name)='lsass.exe' AND LOWER(path)!='c:\\windows\\system32\\lsass.exe' AND path!='';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "lsass.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='lsass.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "services.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name FROM processes WHERE pid=(SELECT parent FROM processes WHERE LOWER(name)='services.exe') AND LOWER(name)!='wininit.exe';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "services.exe_incorrect_parent_process2",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='wininit.exe') AND LOWER(name)='services.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "svchost.exe_incorrect_path",
				"sqlQuery": "SELECT * FROM processes WHERE LOWER(name)='svchost.exe' AND LOWER(path)!='c:\\windows\\system32\\svchost.exe' AND LOWER(path)!='c:\\windows\\syswow64\\svchost.exe' AND path!='';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "svchost.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name FROM processes WHERE pid=(SELECT parent FROM processes WHERE LOWER(name)='svchost.exe') AND LOWER(name)!='services.exe';",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "svchost.exe_incorrect_parent_process2",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='services.exe') AND LOWER(name)='svchost.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='services.exe') AND LOWER(name)='svchost.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "cmd.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='cmd.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes - ATT&CK T1173,T1204",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "powershell.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='powershell.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes - ATT&CK T1173,T1086,T1204",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "notepad++.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad++.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "notepad.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='notepad.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "iexplore.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='iexplore.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "firefox.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe') OR pid=(SELECT pid FROM processes WHERE parent!=(SELECT pid from processes where name='explorer.exe') AND LOWER(name)='firefox.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "chrome.exe_incorrect_parent_process",
				"sqlQuery": "SELECT name as bad_parent_child_name, pid bad_parent_child_pid FROM processes WHERE pid=(SELECT parent FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe') OR pid=(SELECT pid FROM processes WHERE parent != (SELECT pid from processes where name='explorer.exe') AND LOWER(name)='chrome.exe');",
				"description": "Detect processes masquerading as legitimate Windows processes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			}
		]
	},
	{
		"name": "Suspicious Applications",
		"description": "Applications which are either suspicious itself or common applications which are found at a specific location",
		"systemsAvailable": 1,
		"queries": [
			{
				"name": "attrib.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%attrib%';",
				"description": "Attrib Execute, usually used to modify file attributes",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "schtasks.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%schtasks%';",
				"description": "Schtasks Execute, usually used to create a scheduled task",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "taskeng.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%taskeng%';",
				"description": "taskeng Execute, usually used to create a scheduled task",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "tscon.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%tscon%';",
				"description": "tscon.exe Execute, usually used to Terminal Services Console",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "mstsc.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%mstsc%';",
				"description": "mstsc.exe Execute, usually used to perform a RDP Session",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "at.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%at.exe%';",
				"description": "Schtasks Execute, usually used to create a scheduled task",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "tasklist.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%tasklist%';",
				"description": "Tasklist Execute, usually used to list task",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "taskkill.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%taskkill%';",
				"description": "Taskkill Execute, usually used to kill task ",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "mshta.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%mshta%';",
				"description": "Mshta Execute, is a utility that executes Microsoft HTML Applications (HTA)",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "whoami.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%whoami%';",
				"description": "Whoami Execute, used to prints the effective username of the current user",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "xcopy.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%xcopy%';",
				"description": "Xcopy Execute, is used for copying multiple files or entire directory trees from one directory to another and for copying files across a network.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "esentutl.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%esentutl%';",
				"description": "Esentutl Execute, is a legitimate built-in command-line program it could be used to create a exe from dump raw source.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "net.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%net.exe%';",
				"description": "Net Execute, is used in command-line operations for control of users, names, services, and network connections",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "vssadmin.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%vssadmin%';",
				"description": "Vssadmin Execute, usually used to execute activity on Volume Shadow copy",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "InstallUtil.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%InstallUtil%';",
				"description": "InstallUtil Execute, InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "cmstp.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%CMSTP%';",
				"description": "CMSTP Execute, The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "cmd.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%CMD%';",
				"description": "Command-Line Interface Execute, CMD execution",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "cscript.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%cscript%';",
				"description": "Command-Line Interface Execute, Cscript execution starts a script so that it runs in a command-line environment.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "powershell.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%POWERSHELL%';",
				"description": "POWERSHELL Execute, is a powerful interactive command-line interface and scripting environment included in the Windows operating system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "regsvr32.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%regsvr%';",
				"description": "POWERSHELL Execute, is a powerful interactive command-line interface and scripting environment included in the Windows operating system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "PsExec.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%PsExec%';",
				"description": "PsExec Execute, is a free Microsoft tool that can be used to execute a program on another computer.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "runas.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%runas%';",
				"description": "Runas Execute, Allows a user to run specific tools and programs with different permissions than the user's current logon provides.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "bitsadmin.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%bitsadmin%';",
				"description": "Bitsadmin Execute, Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through Component Object Model (COM)",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "certutil.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%certutil%';",
				"description": "Certutil Execute, Certutil.exe is a legitimate built-in command-line program to manage certificates in Windows",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "netsh.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%netsh%';",
				"description": "Netsh Execute, Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "netstat.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%netstat%';",
				"description": "Netstat Execute,  is an operating system utility that displays active TCP connections, listening ports, and network statistics.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "reg.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%reg%';",
				"description": "Reg Execute, Reg is a Windows utility used to interact with the Windows Registry.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "regedit.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%regedit%';",
				"description": "Regedit Execute, is a Windows utility used to interact with the Windows Registry.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "systeminfo.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%systeminfo%';",
				"description": "Systeminfo Execute, Systeminfo is a Windows utility that can be used to gather detailed information about a computer.",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			},
			{
				"name": "sc.exe",
				"sqlQuery": "select * from file WHERE directory = 'C:\\Windows\\Prefetch\\' and filename like '%sc%';",
				"description": "SC.exe Execute, Service Control - Create, Start, Stop, Query or Delete any Windows SERVICE. .",
				"analysisInterval": 1,
				"analysisIntervalUnit": "HOURS",
				"osquery": true,
				"active": 1,
				"systemsAvailable": 1,
				"availabilityCheck": true,
				"fixedSize": false,
				"graphAble": false
			}
		]
	}
]